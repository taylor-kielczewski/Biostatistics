<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Taylor Kielczewski Midterm, 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Kielczewski_Taylor_files/libs/clipboard/clipboard.min.js"></script>
<script src="Kielczewski_Taylor_files/libs/quarto-html/quarto.js"></script>
<script src="Kielczewski_Taylor_files/libs/quarto-html/popper.min.js"></script>
<script src="Kielczewski_Taylor_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Kielczewski_Taylor_files/libs/quarto-html/anchor.min.js"></script>
<link href="Kielczewski_Taylor_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Kielczewski_Taylor_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Kielczewski_Taylor_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Kielczewski_Taylor_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Kielczewski_Taylor_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taylor Kielczewski Midterm, 2025</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>github:</strong></p>
<p><a href="https://github.com/taylor-kielczewski/Biostatistics/tree/main" class="uri">https://github.com/taylor-kielczewski/Biostatistics/tree/main</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading Libraries &amp; setting theme</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemr)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to emmeans.
Caution: You lose important information if you filter this package's results.
See '? untidy'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(paletteer)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="question-1-data-reshaping-and-visualization" class="level1">
<h1><strong>Question 1: Data Reshaping and Visualization</strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1a. Loading Data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>covid <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'https://raw.githubusercontent.com/CSSEGISandData/COVID-19/refs/heads/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 3342 Columns: 1154
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr    (6): iso2, iso3, Admin2, Province_State, Country_Region, Combined_Key
dbl (1148): UID, code3, FIPS, Lat, Long_, 1/22/20, 1/23/20, 1/24/20, 1/25/20...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>covid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,342 × 1,154
        UID iso2  iso3  code3  FIPS Admin2   Province_State Country_Region   Lat
      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;          &lt;chr&gt;          &lt;dbl&gt;
 1 84001001 US    USA     840  1001 Autauga  Alabama        US              32.5
 2 84001003 US    USA     840  1003 Baldwin  Alabama        US              30.7
 3 84001005 US    USA     840  1005 Barbour  Alabama        US              31.9
 4 84001007 US    USA     840  1007 Bibb     Alabama        US              33.0
 5 84001009 US    USA     840  1009 Blount   Alabama        US              34.0
 6 84001011 US    USA     840  1011 Bullock  Alabama        US              32.1
 7 84001013 US    USA     840  1013 Butler   Alabama        US              31.8
 8 84001015 US    USA     840  1015 Calhoun  Alabama        US              33.8
 9 84001017 US    USA     840  1017 Chambers Alabama        US              32.9
10 84001019 US    USA     840  1019 Cherokee Alabama        US              34.2
# ℹ 3,332 more rows
# ℹ 1,145 more variables: Long_ &lt;dbl&gt;, Combined_Key &lt;chr&gt;, `1/22/20` &lt;dbl&gt;,
#   `1/23/20` &lt;dbl&gt;, `1/24/20` &lt;dbl&gt;, `1/25/20` &lt;dbl&gt;, `1/26/20` &lt;dbl&gt;,
#   `1/27/20` &lt;dbl&gt;, `1/28/20` &lt;dbl&gt;, `1/29/20` &lt;dbl&gt;, `1/30/20` &lt;dbl&gt;,
#   `1/31/20` &lt;dbl&gt;, `2/1/20` &lt;dbl&gt;, `2/2/20` &lt;dbl&gt;, `2/3/20` &lt;dbl&gt;,
#   `2/4/20` &lt;dbl&gt;, `2/5/20` &lt;dbl&gt;, `2/6/20` &lt;dbl&gt;, `2/7/20` &lt;dbl&gt;,
#   `2/8/20` &lt;dbl&gt;, `2/9/20` &lt;dbl&gt;, `2/10/20` &lt;dbl&gt;, `2/11/20` &lt;dbl&gt;, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1b. Big &amp; Wide</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filter to a state</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>MA_covid <span class="ot">&lt;-</span> covid <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Province_State <span class="sc">==</span> <span class="st">"Massachusetts"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">select</span>(</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>UID, <span class="sc">-</span>iso2, <span class="sc">-</span>iso3, <span class="sc">-</span>code3, <span class="sc">-</span>FIPS, <span class="sc">-</span>Admin2, </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>Lat, <span class="sc">-</span>Long_, <span class="sc">-</span>Country_Region, <span class="sc">-</span>Province_State, <span class="sc">-</span>Combined_Key</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">|&gt;</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `summarise()`.
ℹ In argument: `across(everything(), sum, na.rm = TRUE)`.
Caused by warning:
! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.
Supply arguments directly to `.fns` through an anonymous function instead.

  # Previously
  across(a:b, mean, na.rm = TRUE)

  # Now
  across(a:b, \(x) mean(x, na.rm = TRUE))</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pivot longer</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  MA_long <span class="ot">&lt;-</span> MA_covid <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"date"</span>, <span class="at">values_to =</span> <span class="st">"cumulative_cases"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># columns for date, new cases, cumulative cases</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  MA_long <span class="ot">&lt;-</span> MA_long <span class="sc">|&gt;</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">date =</span> <span class="fu">as.character</span>(date),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">date =</span><span class="fu">mdy</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">new_cases =</span> cumulative_cases <span class="sc">-</span> <span class="fu">lag</span>(cumulative_cases)) <span class="sc">|&gt;</span> </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(date, new_cases, cumulative_cases) <span class="sc">|&gt;</span> </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">replace</span>(., <span class="fu">is.na</span>(.), <span class="dv">0</span>))</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  MA_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,143 × 3
   date       new_cases cumulative_cases
   &lt;date&gt;         &lt;dbl&gt;            &lt;dbl&gt;
 1 2020-01-22         0                0
 2 2020-01-23         0                0
 3 2020-01-24         0                0
 4 2020-01-25         0                0
 5 2020-01-26         0                0
 6 2020-01-27         0                0
 7 2020-01-28         0                0
 8 2020-01-29         1                1
 9 2020-01-30         0                1
10 2020-01-31         0                1
# ℹ 1,133 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1c. Visualization</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(MA_long, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> cumulative_cases)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">"grey35"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> new_cases), <span class="at">linewidth =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> new_cases), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"rocket"</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'COVID-19 in Massachusetts'</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'Date: {frame_along}'</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">'Date'</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">'Cumulative Cases'</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"New Daily Cases"</span>,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Data from JHU"</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_reveal</span>(date)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-4-1.gif" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="question-2-fit-and-evaluate-a-linear-model" class="level1">
<h1><strong>Question 2: Fit and Evaluate a Linear Model</strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2a. What should I do? </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. load the data </span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. look at data</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. tidy data</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. initial visualization</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. fitting a linear model</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. check assumptions</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. look at parameters</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. plot with statistical parameters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loading data</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>quail <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/Morphology_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 880 Columns: 10
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): Sex, NOTES
dbl (8): Bird #, Age (days), Exp. Temp. (degree C), Mass (g), Tarsus (mm), C...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2b. Let's get started</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(quail)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [880 × 10] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Bird #               : num [1:880] 1 2 3 4 5 6 7 8 9 10 ...
 $ Sex                  : chr [1:880] NA "m" "f" "m" ...
 $ Age (days)           : num [1:880] 5 5 5 5 5 5 5 5 5 5 ...
 $ Exp. Temp. (degree C): num [1:880] 15 15 15 15 15 15 15 15 15 15 ...
 $ Mass (g)             : num [1:880] 16.1 19.2 17.5 14.4 17.4 ...
 $ Tarsus (mm)          : num [1:880] 19.4 20.4 19 20.1 21.8 ...
 $ Culmen (mm)          : num [1:880] 7.64 7.49 7.31 7.34 8.24 6.82 7.84 7.39 7.4 7.81 ...
 $ Depth (mm)           : num [1:880] 4.23 4.46 3.92 3.85 4.42 3.65 3.94 3.72 4.5 4.09 ...
 $ Width (mm)           : num [1:880] 4.49 4.44 4.01 4.22 4.56 3.73 4.6 4.66 3.83 3.89 ...
 $ NOTES                : chr [1:880] NA NA NA NA ...
 - attr(*, "spec")=
  .. cols(
  ..   `Bird #` = col_double(),
  ..   Sex = col_character(),
  ..   `Age (days)` = col_double(),
  ..   `Exp. Temp. (degree C)` = col_double(),
  ..   `Mass (g)` = col_double(),
  ..   `Tarsus (mm)` = col_double(),
  ..   `Culmen (mm)` = col_double(),
  ..   `Depth (mm)` = col_double(),
  ..   `Width (mm)` = col_double(),
  ..   NOTES = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>quail <span class="ot">&lt;-</span> quail <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">bird_number =</span> <span class="fu">as.factor</span>(<span class="st">`</span><span class="at">Bird #</span><span class="st">`</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">as.factor</span>(<span class="st">`</span><span class="at">Age (days)</span><span class="st">`</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_C =</span> <span class="fu">as.factor</span>(<span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span>),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mass_g =</span> <span class="st">`</span><span class="at">Mass (g)</span><span class="st">`</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">tarsus_mm =</span> <span class="st">`</span><span class="at">Tarsus (mm)</span><span class="st">`</span>, </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">culmen_mm =</span> <span class="st">`</span><span class="at">Culmen (mm)</span><span class="st">`</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">depth_mm =</span> <span class="st">`</span><span class="at">Depth (mm)</span><span class="st">`</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">width_mm =</span> <span class="st">`</span><span class="at">Width (mm)</span><span class="st">`</span>,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> Sex,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">notes =</span> NOTES</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Bird #</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Age (days)</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Width (mm)</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Depth (mm)</span><span class="st">`</span>,<span class="sc">-</span><span class="st">`</span><span class="at">Culmen (mm)</span><span class="st">`</span>,<span class="sc">-</span><span class="st">`</span><span class="at">Tarsus (mm)</span><span class="st">`</span>,<span class="sc">-</span><span class="st">`</span><span class="at">Mass (g)</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Exp. Temp. (degree C)</span><span class="st">`</span>, <span class="sc">-</span>Sex, <span class="sc">-</span>NOTES) <span class="sc">|&gt;</span> </span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(bird_number, age, <span class="fu">everything</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2c. Visualization</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>quail_plot <span class="ot">&lt;-</span> quail <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y =</span>tarsus_mm, <span class="at">color =</span> temp_C )) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"15"</span><span class="ot">=</span><span class="st">"steelblue"</span>,<span class="st">"30"</span> <span class="ot">=</span> <span class="st">"coral2"</span>),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"15 °C"</span>, <span class="st">"30 °C"</span>)) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Development of Tarsus Length"</span>, </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Temperature"</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tarsus Length (mm)"</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age (days)"</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>quail_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 112 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2d. Fit and Evaluate</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:patchwork':

    area</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is DHARMa 0.4.7. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>quail_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> quail,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  tarsus_mm <span class="sc">~</span> age <span class="sc">*</span> temp_C <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> bird_number)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>quail_mod <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(quail_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># there are high VIFs in the linear model, but this is to be expected when including bird_number as a block effect &amp; by using a factorial design.  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2e. Interpretation </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quail_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: tarsus_mm ~ age * temp_C + (1 | bird_number)
   Data: quail

REML criterion at convergence: 3130.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.8375 -0.5582 -0.0027  0.5229  5.8978 

Random effects:
 Groups      Name        Variance Std.Dev.
 bird_number (Intercept) 2.211    1.487   
 Residual                3.229    1.797   
Number of obs: 768, groups:  bird_number, 40

Fixed effects:
                Estimate Std. Error t value
(Intercept)     19.73300    0.52153  37.837
age7             0.45200    0.56827   0.795
age9             2.70200    0.56827   4.755
age11            4.62250    0.56827   8.134
age13            5.46245    0.58665   9.311
age15            6.63911    0.58665  11.317
age17            8.44300    0.58665  14.392
age19            9.68467    0.58665  16.509
age21           11.17800    0.58665  19.054
age23           12.10078    0.58665  20.627
age25           13.72189    0.58665  23.390
age27           15.04578    0.58665  25.647
age29           15.51522    0.58665  26.447
age34           17.42300    0.58665  29.699
age39           17.24133    0.58665  29.390
age44           17.20022    0.58665  29.320
age49           16.94300    0.58665  28.881
age51           16.15078    0.58665  27.531
age66           17.51689    0.58665  29.859
age80           16.60261    0.60632  27.383
age123          18.40467    0.58665  31.373
temp_C30         0.08050    0.73756   0.109
age7:temp_C30   -0.08247    0.81105  -0.102
age9:temp_C30    0.57121    0.81105   0.704
age11:temp_C30  -0.07087    0.81105  -0.087
age13:temp_C30   1.27656    0.82403   1.549
age15:temp_C30   0.78433    0.83062   0.944
age17:temp_C30   0.28822    0.83062   0.347
age19:temp_C30   0.44989    0.83062   0.542
age21:temp_C30   0.77711    0.83062   0.936
age23:temp_C30   1.90767    0.83062   2.297
age25:temp_C30   2.21155    0.83062   2.663
age27:temp_C30   1.02155    0.83062   1.230
age29:temp_C30   1.44600    0.83062   1.741
age34:temp_C30   1.41044    0.83062   1.698
age39:temp_C30   1.19211    0.83062   1.435
age44:temp_C30   1.40489    0.83062   1.691
age49:temp_C30   0.36933    0.83062   0.445
age51:temp_C30   1.47767    0.83062   1.779
age66:temp_C30   0.73100    0.83062   0.880
age80:temp_C30   2.99694    0.84463   3.548
age123:temp_C30  0.65489    0.83062   0.788</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 42 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(quail_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 6
   effect group term        estimate std.error statistic
   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 fixed  &lt;NA&gt;  (Intercept)   19.7       0.522    37.8  
 2 fixed  &lt;NA&gt;  age7           0.452     0.568     0.795
 3 fixed  &lt;NA&gt;  age9           2.70      0.568     4.75 
 4 fixed  &lt;NA&gt;  age11          4.62      0.568     8.13 
 5 fixed  &lt;NA&gt;  age13          5.46      0.587     9.31 
 6 fixed  &lt;NA&gt;  age15          6.64      0.587    11.3  
 7 fixed  &lt;NA&gt;  age17          8.44      0.587    14.4  
 8 fixed  &lt;NA&gt;  age19          9.68      0.587    16.5  
 9 fixed  &lt;NA&gt;  age21         11.2       0.587    19.1  
10 fixed  &lt;NA&gt;  age23         12.1       0.587    20.6  
# ℹ 34 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(quail_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.929
     Marginal R2: 0.880</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(quail_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:   Note that you are attempting to plot a 'main effect' in a model that contains an
  interaction.  This is potentially misleading; you may wish to consider using the 'by'
  argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Conditions used in construction of plot
temp_C: 15
bird_number: 2</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning:   Note that you are attempting to plot a 'main effect' in a model that contains an
  interaction.  This is potentially misleading; you may wish to consider using the 'by'
  argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Conditions used in construction of plot
age: 5
bird_number: 2</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fancy Visualization</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>quail_em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(quail_mod, <span class="sc">~</span> temp_C <span class="sc">|</span> age)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>quail_em</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>age = 5:
 temp_C emmean    SE  df lower.CL upper.CL
 15       19.7 0.522 176     18.7     20.8
 30       19.8 0.522 176     18.8     20.8

age = 7:
 temp_C emmean    SE  df lower.CL upper.CL
 15       20.2 0.522 176     19.2     21.2
 30       20.2 0.533 183     19.1     21.2

age = 9:
 temp_C emmean    SE  df lower.CL upper.CL
 15       22.4 0.522 176     21.4     23.5
 30       23.1 0.533 183     22.0     24.1

age = 11:
 temp_C emmean    SE  df lower.CL upper.CL
 15       24.4 0.522 176     23.3     25.4
 30       24.4 0.533 183     23.3     25.4

age = 13:
 temp_C emmean    SE  df lower.CL upper.CL
 15       25.2 0.542 197     24.1     26.3
 30       26.6 0.533 183     25.5     27.6

age = 15:
 temp_C emmean    SE  df lower.CL upper.CL
 15       26.4 0.542 197     25.3     27.4
 30       27.2 0.543 195     26.2     28.3

age = 17:
 temp_C emmean    SE  df lower.CL upper.CL
 15       28.2 0.542 197     27.1     29.2
 30       28.5 0.543 195     27.5     29.6

age = 19:
 temp_C emmean    SE  df lower.CL upper.CL
 15       29.4 0.542 197     28.3     30.5
 30       29.9 0.543 195     28.9     31.0

age = 21:
 temp_C emmean    SE  df lower.CL upper.CL
 15       30.9 0.542 197     29.8     32.0
 30       31.8 0.543 195     30.7     32.8

age = 23:
 temp_C emmean    SE  df lower.CL upper.CL
 15       31.8 0.542 197     30.8     32.9
 30       33.8 0.543 195     32.8     34.9

age = 25:
 temp_C emmean    SE  df lower.CL upper.CL
 15       33.5 0.542 197     32.4     34.5
 30       35.7 0.543 195     34.7     36.8

age = 27:
 temp_C emmean    SE  df lower.CL upper.CL
 15       34.8 0.542 197     33.7     35.8
 30       35.9 0.543 195     34.8     37.0

age = 29:
 temp_C emmean    SE  df lower.CL upper.CL
 15       35.2 0.542 197     34.2     36.3
 30       36.8 0.543 195     35.7     37.8

age = 34:
 temp_C emmean    SE  df lower.CL upper.CL
 15       37.2 0.542 197     36.1     38.2
 30       38.6 0.543 195     37.6     39.7

age = 39:
 temp_C emmean    SE  df lower.CL upper.CL
 15       37.0 0.542 197     35.9     38.0
 30       38.2 0.543 195     37.2     39.3

age = 44:
 temp_C emmean    SE  df lower.CL upper.CL
 15       36.9 0.542 197     35.9     38.0
 30       38.4 0.543 195     37.3     39.5

age = 49:
 temp_C emmean    SE  df lower.CL upper.CL
 15       36.7 0.542 197     35.6     37.7
 30       37.1 0.543 195     36.1     38.2

age = 51:
 temp_C emmean    SE  df lower.CL upper.CL
 15       35.9 0.542 197     34.8     37.0
 30       37.4 0.543 195     36.4     38.5

age = 66:
 temp_C emmean    SE  df lower.CL upper.CL
 15       37.2 0.542 197     36.2     38.3
 30       38.1 0.543 195     37.0     39.1

age = 80:
 temp_C emmean    SE  df lower.CL upper.CL
 15       36.3 0.563 223     35.2     37.4
 30       39.4 0.543 195     38.3     40.5

age = 123:
 temp_C emmean    SE  df lower.CL upper.CL
 15       38.1 0.542 197     37.1     39.2
 30       38.9 0.543 195     37.8     39.9

Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(quail_em, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>age = 5:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -0.08050 0.738 176  -0.109  0.9132

age = 7:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30  0.00197 0.746 180   0.003  0.9979

age = 9:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -0.65171 0.746 180  -0.874  0.3833

age = 11:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -0.00963 0.746 180  -0.013  0.9897

age = 13:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -1.35706 0.760 190  -1.786  0.0757

age = 15:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -0.86483 0.767 196  -1.128  0.2609

age = 17:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -0.36872 0.767 196  -0.481  0.6312

age = 19:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -0.53039 0.767 196  -0.692  0.4901

age = 21:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -0.85761 0.767 196  -1.118  0.2649

age = 23:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -1.98817 0.767 196  -2.592  0.0103

age = 25:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -2.29205 0.767 196  -2.988  0.0032

age = 27:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -1.10205 0.767 196  -1.437  0.1524

age = 29:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -1.52650 0.767 196  -1.990  0.0480

age = 34:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -1.49094 0.767 196  -1.944  0.0533

age = 39:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -1.27261 0.767 196  -1.659  0.0987

age = 44:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -1.48539 0.767 196  -1.937  0.0542

age = 49:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -0.44983 0.767 196  -0.586  0.5582

age = 51:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -1.55817 0.767 196  -2.031  0.0436

age = 66:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -0.81150 0.767 196  -1.058  0.2914

age = 80:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -3.07744 0.782 209  -3.935  0.0001

age = 123:
 contrast            estimate    SE  df t.ratio p.value
 temp_C15 - temp_C30 -0.73539 0.767 196  -0.959  0.3389

Degrees-of-freedom method: kenward-roger </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>em_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(quail_em)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(em_df, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> emmean, <span class="at">color =</span> temp_C)) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>,<span class="st">"coral2"</span>))<span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower.CL, <span class="at">ymax =</span> upper.CL), <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Estimated Marginal Means of</span><span class="sc">\n</span><span class="st"> Tarsus Length by Age and Temperature"</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (days)"</span>,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Estimated Tarsus Length (mm)"</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Temperature (°C)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_line()`: Each group consists of only one observation.
ℹ Do you need to adjust the group aesthetic?</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># According to the simulated model, early life temperatures significantly influences the tarsus length in Japanese quail. There are minimal differences at early life stages, but at day 21+, quail chicks exposed to 30°C temperatures have longer tarsus lengths. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-3-something-generalized" class="level1">
<h1><strong>Question 3: Something Generalized</strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3a. Fit a GLM </span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. load the data </span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>rhiz <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/greenhouse_inoculation_expt_2010.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 240 Columns: 16
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (4): rhizobia, rhiz_region, plant_pop, date_planted
dbl (12): rack, bench, bench_pos, rack_pos, in_leaf_num, in_height, leaf_mar...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>rhiz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 240 × 16
    rack bench bench_pos rack_pos rhizobia rhiz_region plant_pop date_planted
   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;       
 1     1     1         1        1 rSCWRS   edge        KZA       28-Jan-10   
 2     1     1         1        2 rSCWRS   edge        GCD       28-Jan-10   
 3     1     1         1        3 rSCWRS   edge        TYS       28-Jan-10   
 4     1     1         1        4 rSCWRS   edge        CRA       31-Jan-10   
 5     1     1         1        5 rSCWRS   edge        CRA       31-Jan-10   
 6     1     1         1        6 rSCWRS   edge        TYS       28-Jan-10   
 7     1     1         1        7 rSCWRS   edge        GCD       28-Jan-10   
 8     1     1         1        8 rSCWRS   edge        KZA       28-Jan-10   
 9     2     1         2        1 rACNW    beyond      GCD       8-Feb-10    
10     2     1         2        2 rACNW    beyond      TYS       1-Feb-10    
# ℹ 230 more rows
# ℹ 8 more variables: in_leaf_num &lt;dbl&gt;, in_height &lt;dbl&gt;, leaf_mar12 &lt;dbl&gt;,
#   height_mar12 &lt;dbl&gt;, branch_mar12 &lt;dbl&gt;, flower_mar23 &lt;dbl&gt;,
#   height_apr20 &lt;dbl&gt;, nodule_count &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. look at data</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(rhiz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 240
Columns: 16
$ rack         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, …
$ bench        &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ bench_pos    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, …
$ rack_pos     &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 1, 2, 3, 4, 5, 6, 7, 8, 1, 2, 3, …
$ rhizobia     &lt;chr&gt; "rSCWRS", "rSCWRS", "rSCWRS", "rSCWRS", "rSCWRS", "rSCWRS…
$ rhiz_region  &lt;chr&gt; "edge", "edge", "edge", "edge", "edge", "edge", "edge", "…
$ plant_pop    &lt;chr&gt; "KZA", "GCD", "TYS", "CRA", "CRA", "TYS", "GCD", "KZA", "…
$ date_planted &lt;chr&gt; "28-Jan-10", "28-Jan-10", "28-Jan-10", "31-Jan-10", "31-J…
$ in_leaf_num  &lt;dbl&gt; 3, 2, 4, 3, 3, 4, 4, 3, 2, 3, 5, 5, 4, 5, 2, 3, 2, 3, 4, …
$ in_height    &lt;dbl&gt; 6.0, 1.5, 7.5, 5.5, 5.0, 6.5, 7.5, 5.5, 5.0, 4.0, 7.5, 8.…
$ leaf_mar12   &lt;dbl&gt; 7, 1, 9, 10, 8, 10, 7, 8, 8, 7, 8, 10, 8, 10, 7, 8, 6, 6,…
$ height_mar12 &lt;dbl&gt; 10.5, 5.0, 14.0, 12.0, 9.5, 13.5, 12.5, 10.5, 12.5, 11.0,…
$ branch_mar12 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ flower_mar23 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ height_apr20 &lt;dbl&gt; 31.5, 0.0, 29.0, 37.0, 32.0, 26.5, 34.0, 27.0, 33.0, 31.0…
$ nodule_count &lt;dbl&gt; 26, 0, 33, 55, 19, 30, 42, 34, 34, 31, 41, 25, 38, 30, 48…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      rack          bench     bench_pos       rack_pos      rhizobia        
 Min.   : 1.0   Min.   :1   Min.   : 1.0   Min.   :1.00   Length:240        
 1st Qu.: 8.0   1st Qu.:1   1st Qu.: 3.0   1st Qu.:2.75   Class :character  
 Median :15.5   Median :2   Median : 5.5   Median :4.50   Mode  :character  
 Mean   :15.5   Mean   :2   Mean   : 5.5   Mean   :4.50                     
 3rd Qu.:23.0   3rd Qu.:3   3rd Qu.: 8.0   3rd Qu.:6.25                     
 Max.   :30.0   Max.   :3   Max.   :10.0   Max.   :8.00                     
 rhiz_region         plant_pop         date_planted        in_leaf_num   
 Length:240         Length:240         Length:240         Min.   :0.000  
 Class :character   Class :character   Class :character   1st Qu.:2.000  
 Mode  :character   Mode  :character   Mode  :character   Median :3.000  
                                                          Mean   :3.146  
                                                          3rd Qu.:4.000  
                                                          Max.   :6.000  
   in_height        leaf_mar12      height_mar12    branch_mar12   
 Min.   : 1.000   Min.   : 1.000   Min.   : 3.00   Min.   :0.0000  
 1st Qu.: 4.500   1st Qu.: 6.000   1st Qu.: 8.50   1st Qu.:0.0000  
 Median : 6.000   Median : 8.000   Median :11.00   Median :0.0000  
 Mean   : 5.775   Mean   : 7.854   Mean   :11.21   Mean   :0.2292  
 3rd Qu.: 7.000   3rd Qu.: 9.000   3rd Qu.:13.00   3rd Qu.:0.0000  
 Max.   :10.500   Max.   :21.000   Max.   :22.50   Max.   :4.0000  
  flower_mar23      height_apr20    nodule_count   
 Min.   :0.00000   Min.   : 0.00   Min.   :  0.00  
 1st Qu.:0.00000   1st Qu.:17.38   1st Qu.:  0.00  
 Median :0.00000   Median :27.00   Median : 11.00  
 Mean   :0.04583   Mean   :25.04   Mean   : 32.55  
 3rd Qu.:0.00000   3rd Qu.:32.00   3rd Qu.: 51.25  
 Max.   :1.00000   Max.   :46.00   Max.   :241.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(rhiz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. tidy data</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>rhiz <span class="ot">&lt;-</span> rhiz <span class="sc">|&gt;</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>rack,<span class="sc">-</span>bench,<span class="sc">-</span>bench_pos,<span class="sc">-</span>rack_pos,<span class="sc">-</span>flower_mar23,<span class="sc">-</span>height_apr20,)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. initial visualization</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>rhiz_plot <span class="ot">&lt;-</span> rhiz <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>leaf_mar12, <span class="at">x=</span>height_mar12, <span class="at">color =</span> rhiz_region))<span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">8</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_paletteer_d</span>(<span class="st">"nationalparkcolors::Acadia"</span>) <span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Leaves vs Height'</span>,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height"</span>,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Leaves"</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Rhizobia Region"</span>,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"data from doi.org/10.5061/dryad.8566"</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>rhiz_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. fitting a linear model</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>rhiz_mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data =</span> rhiz, </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>               leaf_mar12 <span class="sc">~</span> height_mar12<span class="sc">+</span>rhiz_region,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. check assumptions</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(rhiz_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(rhiz_mod) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. look at parameters</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rhiz_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = leaf_mar12 ~ height_mar12 + rhiz_region, family = poisson(link = "log"), 
    data = rhiz)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          1.602655   0.095246  16.826  &lt; 2e-16 ***
height_mar12         0.047548   0.006638   7.163 7.89e-13 ***
rhiz_regionc        -0.269131   0.082740  -3.253  0.00114 ** 
rhiz_regionedge     -0.073462   0.069421  -1.058  0.28996    
rhiz_regioninterior -0.071084   0.065658  -1.083  0.27897    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 224.30  on 239  degrees of freedom
Residual deviance: 154.29  on 235  degrees of freedom
AIC: 1091.2

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. plot with statistical parameters</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>rhiz <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>leaf_mar12, <span class="at">x=</span>height_mar12, <span class="at">color =</span> rhiz_region))<span class="sc">+</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_paletteer_d</span>(<span class="st">"nationalparkcolors::Acadia"</span>) <span class="sc">+</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Leaves vs Height'</span>,</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height"</span>,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Leaves"</span>,</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Rhizobia Region"</span>,</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"data from doi.org/10.5061/dryad.8566"</span>)<span class="sc">+</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> rhiz_region)<span class="sc">+</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> glm,</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I chose a GLM with a Poisson error distribution with a log link because the response variable is count data.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3b.</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(rhiz_mod))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        (Intercept)        height_mar12        rhiz_regionc     rhiz_regionedge 
          4.9661980           1.0486960           0.7640435           0.9291712 
rhiz_regioninterior 
          0.9313838 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plants inoculated with rhizobia from the "beyond" region produced the most leaves on average, followed by the "interior" and "edge" regions, respectively. All rhizobia-inoculated plants developed more leaves than those in the "c" group, which served as the control. These results suggest that rhizobia enhance early leaf development, with the greatest benefit observed from the beyond-region inoculation. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3c. Prediction Intervals from a distribution</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Poisson Distribution </span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>q025 <span class="ot">&lt;-</span> <span class="fu">qpois</span>(<span class="fl">0.025</span>, <span class="at">lambda =</span> lambda)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>q975 <span class="ot">&lt;-</span> <span class="fu">qpois</span>(<span class="fl">0.975</span>, <span class="at">lambda =</span> lambda)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>poisson <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">lambda =</span> lambda,</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> q025,</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> q975)</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>poisson</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 3
   lambda lower upper
    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
 1      1     0     3
 2      2     0     5
 3      3     0     7
 4      4     1     8
 5      5     1    10
 6      6     2    11
 7      7     2    13
 8      8     3    14
 9      9     4    15
10     10     4    17
# ℹ 20 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>p_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(poisson, <span class="fu">aes</span>(<span class="at">x =</span> lambda)) <span class="sc">+</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">fill =</span> <span class="st">"skyblue1"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> lower), <span class="at">color =</span> <span class="st">"blue4"</span>) <span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> upper), <span class="at">color =</span> <span class="st">"blue4"</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>p_plot <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"95% Prediction Intervals for Poisson Distributions"</span>,</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Poisson Mean (λ)"</span>,</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count Range (95% Interval)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Negative Binomial </span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> mu,</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">qnbinom</span>(<span class="fl">0.025</span>, <span class="at">mu =</span> mu, <span class="at">size =</span> size),</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">qnbinom</span>(<span class="fl">0.975</span>, <span class="at">mu =</span> mu, <span class="at">size =</span> size)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>nb_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(nb, <span class="fu">aes</span>(<span class="at">x =</span> mu)) <span class="sc">+</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">fill =</span> <span class="st">"tomato"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> lower), <span class="at">color =</span> <span class="st">"red3"</span>) <span class="sc">+</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> upper), <span class="at">color =</span> <span class="st">"red3"</span>) </span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>nb_plot <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"95% Prediction Intervals for Negative Binomial Distributions"</span>,</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Mean (μ)"</span>,</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count Range (95% Interval)"</span>,</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"size = 10"</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>big_plot <span class="ot">&lt;-</span> p_plot <span class="sc">+</span> nb_plot <span class="sc">+</span> <span class="fu">plot_annotation</span>(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"95% Prediction Intervals for Poisson and Negative Binomial Distributions"</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>big_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3d. Prediction Intervals</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>summary_heights <span class="ot">&lt;-</span> rhiz <span class="sc">|&gt;</span> </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rhiz_region) <span class="sc">|&gt;</span> </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">height_mar12 =</span> <span class="fu">c</span>(<span class="fu">min</span>(height_mar12), <span class="fu">mean</span>(height_mar12), <span class="fu">max</span>(height_mar12)),</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">height_type =</span> <span class="fu">c</span>(<span class="st">"min"</span>, <span class="st">"mean"</span>, <span class="st">"max"</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>rhiz_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>  rhiz_mod,</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> summary_heights,</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>summary_heights <span class="ot">&lt;-</span> summary_heights <span class="sc">|&gt;</span> </span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit_link =</span> rhiz_predict<span class="sc">$</span>fit,</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_link =</span> rhiz_predict<span class="sc">$</span>se.fit,</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit_resp =</span> <span class="fu">exp</span>(fit_link),</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_fit =</span> <span class="fu">exp</span>(fit_link <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> se_link),</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_fit =</span> <span class="fu">exp</span>(fit_link <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> se_link),</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_pred =</span> <span class="fu">qpois</span>(<span class="fl">0.025</span>, <span class="at">lambda =</span> fit_resp),</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_pred =</span> <span class="fu">qpois</span>(<span class="fl">0.975</span>, <span class="at">lambda =</span> fit_resp)</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_heights, <span class="fu">aes</span>(<span class="at">x =</span> height_mar12, <span class="at">y =</span> fit_resp, <span class="at">color =</span> rhiz_region)) <span class="sc">+</span></span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower_fit, <span class="at">ymax =</span> upper_fit), <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span> </span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower_pred, <span class="at">ymax =</span> upper_pred), <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span>    </span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_paletteer_d</span>(<span class="st">"nationalparkcolors::Acadia"</span>) <span class="sc">+</span></span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Fitted Values with 95% Fit and Prediction Intervals"</span>,</span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Height (cm)"</span>,</span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Number of Leaves (on Response Scale)"</span>,</span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Rhizobia Region"</span></span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_wrap</span>(<span class="sc">~</span> height_type, <span class="at">scales =</span> <span class="st">"free_x"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="question-4-mix-it-up" class="level1">
<h1><strong>Question 4: Mix it up!</strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4a. Load &amp; Plot</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>reedfrogs <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"https://github.com/rmcelreath/rethinking/raw/master/data/reedfrogs.csv"</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">delim =</span> <span class="st">";"</span>) <span class="sc">|&gt;</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tank =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>() <span class="sc">|&gt;</span> <span class="fu">as.character</span>(),</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">died =</span> density <span class="sc">-</span> surv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 48 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ";"
chr (2): pred, size
dbl (3): density, surv, propsurv

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>frog_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> reedfrogs, <span class="fu">aes</span>(<span class="at">y=</span>surv, <span class="at">x =</span> size, <span class="at">color =</span> pred)) <span class="sc">+</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">8</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"no"</span> <span class="ot">=</span> <span class="st">"#D95F30FF"</span>, <span class="st">"pred"</span> <span class="ot">=</span> <span class="st">"#3A488AFF"</span>))<span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>density)<span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Survivorship by Tank Size and Predator Treatment"</span>,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Tank Size"</span>,</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Frogs Survived"</span>,</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Predator Present"</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>frog_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>reedfrogs_expanded <span class="ot">&lt;-</span> reedfrogs <span class="sc">|&gt;</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tank, size, pred, density) <span class="sc">|&gt;</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">status =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, surv), <span class="fu">rep</span>(<span class="dv">0</span>, died))) <span class="sc">|&gt;</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>frog_ex_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>reedfrogs_expanded, <span class="fu">aes</span>(<span class="at">x=</span>size, <span class="at">y =</span> status, <span class="at">color =</span> pred)) <span class="sc">+</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"no"</span> <span class="ot">=</span> <span class="st">"#D95F30FF"</span>, <span class="st">"pred"</span> <span class="ot">=</span> <span class="st">"#3A488AFF"</span>))<span class="sc">+</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>density) <span class="sc">+</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Died"</span>, <span class="st">"Survived"</span>)) <span class="sc">+</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Survivorship by Tank Size and Density"</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Tank Size"</span>,</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Status"</span>,</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Predator Present"</span></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>frog_ex_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#4b. Am I over it? </span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>frog_mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data =</span> reedfrogs_expanded, status <span class="sc">~</span> pred<span class="sc">*</span>size, <span class="at">family =</span> binomial, <span class="at">weights =</span> density)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(frog_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(frog_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

 dispersion ratio =   2.323
          p-value = &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># there is overdispersion detected</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4c. Fixed or Random Intercept</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>frog_mm <span class="ot">&lt;-</span> <span class="fu">glmer</span>(status <span class="sc">~</span> size<span class="sc">*</span>pred <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>tank), </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weights =</span> density, </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial,</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> reedfrogs_expanded)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(frog_mm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(frog_mm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

 dispersion ratio =   2.073
          p-value = &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># there is slightly less overdispersion in the mixed effects model including tank random effects. The random tank effect accounts for heterogeneity between the groups, which reduces random variance observed in the model.  </span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>frog_FE_mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data =</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  reedfrogs_expanded,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  status <span class="sc">~</span> size<span class="sc">*</span>pred <span class="sc">+</span> tank,</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> density,</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(frog_FE_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = status ~ size * pred + tank, family = binomial, 
    data = reedfrogs_expanded, weights = density)

Coefficients: (3 not defined because of singularities)
                     Estimate Std. Error    z value Pr(&gt;|z|)    
(Intercept)         2.197e+00  3.333e-01  6.592e+00 4.35e-11 ***
sizesmall           5.325e-09  4.714e-01  0.000e+00 1.000000    
predpred           -2.603e+00  3.909e-01 -6.659e+00 2.76e-11 ***
tank10              2.603e+00  3.909e-01  6.659e+00 2.76e-11 ***
tank11              1.253e+00  2.988e-01  4.193e+00 2.76e-05 ***
tank12              8.109e-01  2.887e-01  2.809e+00 0.004967 ** 
tank13              1.253e+00  5.581e-01  2.245e+00 0.024795 *  
tank14              4.055e-01  5.513e-01  7.360e-01 0.462021    
tank15              2.603e+00  6.124e-01  4.250e+00 2.14e-05 ***
tank16              2.603e+00  6.124e-01  4.250e+00 2.14e-05 ***
tank17              9.808e-01  3.909e-01  2.509e+00 0.012095 *  
tank18              2.451e-01  3.645e-01  6.730e-01 0.501256    
tank19             -2.048e-01  3.553e-01 -5.760e-01 0.564384    
tank2               1.392e+01  1.918e+02  7.300e-02 0.942148    
tank20              1.477e+01  1.170e+02  1.260e-01 0.899599    
tank21              2.451e-01  3.645e-01  6.730e-01 0.501256    
tank22              2.451e-01  3.645e-01  6.730e-01 0.501256    
tank23              2.451e-01  3.645e-01  6.730e-01 0.501256    
tank24             -5.390e-01  3.507e-01 -1.537e+00 0.124353    
tank25             -7.472e-01  2.246e-01 -3.327e+00 0.000878 ***
tank26              4.855e-01  2.193e-01  2.214e+00 0.026811 *  
tank27             -1.253e+00  2.315e-01 -5.413e+00 6.21e-08 ***
tank28             -1.699e-01  2.205e-01 -7.710e-01 0.440950    
tank29              4.855e-01  5.199e-01  9.340e-01 0.350385    
tank3              -1.350e+00  3.984e-01 -3.388e+00 0.000703 ***
tank30              1.792e+00  5.233e-01  3.424e+00 0.000618 ***
tank31             -3.483e-01  5.208e-01 -6.690e-01 0.503636    
tank32             -4.335e-09  5.201e-01  0.000e+00 1.000000    
tank33              1.329e+00  3.749e-01  3.546e+00 0.000392 ***
tank34              6.061e-01  3.553e-01  1.706e+00 0.088042 .  
tank35              6.061e-01  3.553e-01  1.706e+00 0.088042 .  
tank36              3.860e+14  1.917e+06  2.013e+08  &lt; 2e-16 ***
tank37              3.860e+14  1.917e+06  2.013e+08  &lt; 2e-16 ***
tank38              1.509e+01  9.821e+01  1.540e-01 0.877900    
tank39              6.061e-01  3.553e-01  1.706e+00 0.088042 .  
tank4               1.392e+01  1.918e+02  7.300e-02 0.942148    
tank40              1.699e-01  3.486e-01  4.870e-01 0.626001    
tank41             -3.860e+14  1.917e+06 -2.013e+08  &lt; 2e-16 ***
tank42             -2.451e-01  2.128e-01 -1.152e+00 0.249397    
tank43             -1.206e-01  2.125e-01 -5.680e-01 0.570295    
tank44              1.162e-09  2.123e-01  0.000e+00 1.000000    
tank45              9.316e-01  5.171e-01  1.802e+00 0.071620 .  
tank46             -2.451e-01  5.172e-01 -4.740e-01 0.635552    
tank47              3.860e+14  1.917e+06  2.013e+08  &lt; 2e-16 ***
tank48              3.483e-01  5.169e-01  6.740e-01 0.500391    
tank5               1.897e-15  4.714e-01  0.000e+00 1.000000    
tank6               7.282e-15  4.714e-01  0.000e+00 1.000000    
tank7               1.392e+01  1.918e+02  7.300e-02 0.942148    
tank8                      NA         NA         NA       NA    
tank9                      NA         NA         NA       NA    
sizesmall:predpred         NA         NA         NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 38661  on 1119  degrees of freedom
Residual deviance: 62620  on 1072  degrees of freedom
AIC: 62716

Number of Fisher Scoring iterations: 13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(frog_FE_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

 dispersion ratio =   1.825
          p-value = &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using a FE of tank would treat each tank as its own level, which would add a bunch of dummy variables to the model. The model would then try to explain the variability between the individual tanks, rather than explaining the random effect.The model would become oversaturated.  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4d. Changes in Parameters</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(frog_mod)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept)         2.6703860 0.04600852  58.041117 0.000000e+00
predpred           -3.3837944 0.05193909 -65.149275 0.000000e+00
sizesmall          -0.1764169 0.06273838  -2.811945 4.924286e-03
predpred:sizesmall  1.1711534 0.07099313  16.496714 3.874081e-61</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(frog_mm)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept)         3.1401209  0.3755993  8.3602947 6.256180e-17
sizesmall          -0.2889213  0.5230582 -0.5523693 5.806954e-01
predpred           -3.4781227  0.5174233 -6.7220067 1.792387e-11
sizesmall:predpred  1.2352884  0.7264579  1.7004266 8.905070e-02</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding the random intercept allowed for variation in the baseline level of the response variable across all of the different groups. The fixed effects represents the average effect of the independent variables across all of the groups.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4e. Model Evaluation</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>frog_em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(frog_mm, <span class="sc">~</span> pred <span class="sc">|</span> size, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>frog_em</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>size = big:
 pred  prob     SE  df asymp.LCL asymp.UCL
 no   0.959 0.0149 Inf     0.917     0.980
 pred 0.416 0.0866 Inf     0.262     0.589

size = small:
 pred  prob     SE  df asymp.LCL asymp.UCL
 no   0.945 0.0190 Inf     0.894     0.973
 pred 0.648 0.0814 Inf     0.477     0.787

Confidence level used: 0.95 
Intervals are back-transformed from the logit scale </code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(frog_em, <span class="at">method =</span> <span class="st">"pairwise"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>size = big:
 contrast  odds.ratio    SE  df null z.ratio p.value
 no / pred      32.40 16.80 Inf    1   6.722  &lt;.0001

size = small:
 contrast  odds.ratio    SE  df null z.ratio p.value
 no / pred       9.42  4.83 Inf    1   4.378  &lt;.0001

Tests are performed on the log odds ratio scale </code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>froggy_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(frog_em)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>em_froggy_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(froggy_df, <span class="fu">aes</span>(<span class="at">x =</span> size, <span class="at">y =</span> prob, <span class="at">color =</span> pred)) <span class="sc">+</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"no"</span> <span class="ot">=</span> <span class="st">"#D95F30FF"</span>, <span class="st">"pred"</span> <span class="ot">=</span> <span class="st">"#3A488AFF"</span>))<span class="sc">+</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> asymp.LCL, <span class="at">ymax =</span> asymp.UCL),</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"black"</span>)  <span class="sc">+</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Estimated Survival Probability</span><span class="sc">\n</span><span class="st"> by Tank Size and Predator Treatment"</span>,</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Tank Size"</span>,</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Estimated Probability of Survival"</span>,</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Predator"</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>em_froggy_plot <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">data =</span> reedfrogs_expanded,</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> size, <span class="at">y =</span> status, <span class="at">color =</span> pred),</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.09</span>,</span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="fl">0.05</span>,</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>density, <span class="at">labeller =</span> label_both) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_line()`: Each group consists of only one observation.
ℹ Do you need to adjust the group aesthetic?
`geom_line()`: Each group consists of only one observation.
ℹ Do you need to adjust the group aesthetic?
`geom_line()`: Each group consists of only one observation.
ℹ Do you need to adjust the group aesthetic?</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Kielczewski_Taylor_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="what-did-we-do" class="level3">
<h3 class="anchored" data-anchor-id="what-did-we-do"><strong>5. What did we do?</strong></h3>
<p><span class="math display">\[
  Y_{ij} = \beta_0 + \beta_1 X_{ij} + \alpha_j + \epsilon_{ij}
\]</span></p>
<p><span class="math display">\[
\alpha_j \sim N(0,\sigma^2_{\alpha})
\]</span></p>
<p><span class="math display">\[
\epsilon_{ij} \sim N(0,\sigma^2)
\]</span></p>
<p>Where <span class="math inline">\(Y_{ij}\)</span> is the probability of a tadpole surviving</p>
<p><span class="math inline">\(\beta_0\)</span> is the fixed effect intercept</p>
<p><span class="math inline">\(\beta_1\)</span> is effect of size</p>
<p><span class="math inline">\(X_{ij}\)</span> is the effect of treatment</p>
<p><span class="math inline">\(\alpha_j\)</span> is the deviation due to random tank variation</p>
<p><span class="math inline">\(\epsilon_{ij}\)</span> is error</p>
</section>
</section>
<section id="self-evaluation" class="level1">
<h1><strong>Self Evaluation</strong></h1>
<section id="a.-im-okay" class="level3">
<h3 class="anchored" data-anchor-id="a.-im-okay">A. I’m okay!</h3>
</section>
<section id="b.-i-am-feeling-more-comfortable-with-ggplot-and-visualization-and-tidying-data." class="level3">
<h3 class="anchored" data-anchor-id="b.-i-am-feeling-more-comfortable-with-ggplot-and-visualization-and-tidying-data.">B. I am feeling more comfortable with ggplot and visualization, and tidying data.</h3>
</section>
<section id="c.-nothing-is-really-easy-but-i-would-say-picking-color-palettes-themes-has-been-the-most-fun." class="level3">
<h3 class="anchored" data-anchor-id="c.-nothing-is-really-easy-but-i-would-say-picking-color-palettes-themes-has-been-the-most-fun.">C. Nothing is really easy – but I would say picking color palettes &amp; themes has been the most fun.</h3>
</section>
<section id="d.-i-feel-as-though-ive-learned-a-lot-rather-quickly.-i-started-off-the-semester-with-a-basic-knowledge-of-bash-and-r-and-i-feel-pretty-confident-with-my-foundation-of-knowledge.-i-can-troubleshoot-my-own-problems-and-know-the-resources-to-use-when-i-need-additional-help." class="level3">
<h3 class="anchored" data-anchor-id="d.-i-feel-as-though-ive-learned-a-lot-rather-quickly.-i-started-off-the-semester-with-a-basic-knowledge-of-bash-and-r-and-i-feel-pretty-confident-with-my-foundation-of-knowledge.-i-can-troubleshoot-my-own-problems-and-know-the-resources-to-use-when-i-need-additional-help.">D. I feel as though I’ve learned a lot rather quickly. I started off the semester with a basic knowledge of bash and R, and I feel pretty confident with my foundation of knowledge. I can troubleshoot my own problems and know the resources to use when I need additional help.</h3>
</section>
<section id="e.-i-eventually-want-to-go-to-graduate-school.-my-experience-in-this-class-will-help-me-prep-for-higher-level-statistical-analysis-and-coding." class="level3">
<h3 class="anchored" data-anchor-id="e.-i-eventually-want-to-go-to-graduate-school.-my-experience-in-this-class-will-help-me-prep-for-higher-level-statistical-analysis-and-coding.">E. I eventually want to go to graduate school. My experience in this class will help me prep for higher level statistical analysis and coding.</h3>
</section>
<section id="f.-i-have-only-taken-intro-to-stats-so-some-of-the-more-complex-statistical-terms-analyses-can-be-a-bit-tough-for-me.-i-want-to-become-more-comfortable-using-these-tests-and-knowing-what-exactly-the-results-mean." class="level3">
<h3 class="anchored" data-anchor-id="f.-i-have-only-taken-intro-to-stats-so-some-of-the-more-complex-statistical-terms-analyses-can-be-a-bit-tough-for-me.-i-want-to-become-more-comfortable-using-these-tests-and-knowing-what-exactly-the-results-mean.">F. I have only taken intro to stats, so some of the more complex statistical terms / analyses can be a bit tough for me. I want to become more comfortable using these tests and knowing what exactly the results mean.</h3>
</section>
<section id="g.-i-have-completed-all-of-the-assignments-thus-far.-this-has-been-helpful-for-my-growth-as-a-student-and-researcher-and-has-pushed-my-boundaries.-ive-had-to-become-comfortable-with-not-immediately-understanding-something-the-first-time-which-is-definitely-an-important-skill-if-i-continue-on-to-higher-education." class="level3">
<h3 class="anchored" data-anchor-id="g.-i-have-completed-all-of-the-assignments-thus-far.-this-has-been-helpful-for-my-growth-as-a-student-and-researcher-and-has-pushed-my-boundaries.-ive-had-to-become-comfortable-with-not-immediately-understanding-something-the-first-time-which-is-definitely-an-important-skill-if-i-continue-on-to-higher-education.">G. I have completed all of the assignments thus far. This has been helpful for my growth as a student and researcher, and has pushed my boundaries. I’ve had to become comfortable with not immediately understanding something the first time, which is definitely an important skill if I continue on to higher education.</h3>
</section>
<section id="h.-this-exam-definitely-stretched-my-abilities.-i-needed-to-go-back-into-previous-labs-to-revisit-work-weve-done-to-apply-it-to-the-midterm-and-do-outside-research-to-build-upon-that.-this-midterm-was-definitely-a-challenge-but-i-feel-a-bit-more-confident-about-my-skills-and-ability-to-troubleshoot-use-stack-overflow" class="level3">
<h3 class="anchored" data-anchor-id="h.-this-exam-definitely-stretched-my-abilities.-i-needed-to-go-back-into-previous-labs-to-revisit-work-weve-done-to-apply-it-to-the-midterm-and-do-outside-research-to-build-upon-that.-this-midterm-was-definitely-a-challenge-but-i-feel-a-bit-more-confident-about-my-skills-and-ability-to-troubleshoot-use-stack-overflow">H. This exam definitely stretched my abilities. I needed to go back into previous labs to revisit work we’ve done to apply it to the midterm, and do outside research to build upon that. This midterm was definitely a challenge, but I feel a bit more confident about my skills (and ability to troubleshoot &amp; use stack overflow!)</h3>
</section>
<section id="i.-sufficient.-i-feel-confident-in-my-graphs-but-for-some-of-the-modeling-i-am-unsure-if-i-made-the-correct-choices-for-type-of-linear-regression-and-statistical-parameters-to-show." class="level3">
<h3 class="anchored" data-anchor-id="i.-sufficient.-i-feel-confident-in-my-graphs-but-for-some-of-the-modeling-i-am-unsure-if-i-made-the-correct-choices-for-type-of-linear-regression-and-statistical-parameters-to-show.">I. Sufficient. I feel confident in my graphs, but for some of the modeling I am unsure if I made the correct choices for type of linear regression and statistical parameters to show.</h3>
</section>
<section id="j.-sufficient.-i-feel-as-though-ive-worked-hard-but-i-still-have-to-brush-up-on-some-statistical-knowledge-and-review-previous-lectures." class="level3">
<h3 class="anchored" data-anchor-id="j.-sufficient.-i-feel-as-though-ive-worked-hard-but-i-still-have-to-brush-up-on-some-statistical-knowledge-and-review-previous-lectures.">J. Sufficient. I feel as though I’ve worked hard, but I still have to brush up on some statistical knowledge and review previous lectures.</h3>
</section>
<section id="k.-i-want-to-become-more-comfortable-using-higher-level-statistics-to-create-meaningful-and-significant-deductions-from-my-data.-i-also-want-to-have-the-knowledge-base-to-interpret-more-statistical-analysis-in-scientific-papers-that-i-read.-also-i-am-still-having-trouble-understanding-when-assumptions-are-correct-enough." class="level3">
<h3 class="anchored" data-anchor-id="k.-i-want-to-become-more-comfortable-using-higher-level-statistics-to-create-meaningful-and-significant-deductions-from-my-data.-i-also-want-to-have-the-knowledge-base-to-interpret-more-statistical-analysis-in-scientific-papers-that-i-read.-also-i-am-still-having-trouble-understanding-when-assumptions-are-correct-enough.">K. I want to become more comfortable using higher level statistics to create meaningful and significant deductions from my data. I also want to have the knowledge base to interpret more statistical analysis in scientific papers that I read. Also, I am still having trouble understanding when assumptions are “correct enough”.</h3>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>